
## Task 1: Simple Linear Regression

### Task 1.1: Download the MP3_data and set the work directory where you saved the dataset.

```{r}
# Download the MP3_data
# Set the work directory where you saved the MP3_data
#done
```

### Task 1.2: Download and load the required packages.

```{r}
# Your code goes here
#loading required libraries
library(readr)
library(ggplot2)
library(ggpubr)
```

### Task 1.3: Load, view the Mp3_ds dataset, and returning the Mp3_ds dataset structure.

```{r}
# Your code goes here
Mp3_ds <- read.csv("MP3_data.csv") #loading dataset
#View(Mp3_ds) #View dataset
str(Mp3_ds) # str of the dataset
```

### Task 1.4: Adding a scatter plot with points and trendline. Adding R^2 value and the linear regression model equation to the plot

```{r}
# Your code goes here
#creating the scatter plot of linear model
ggplot(Mp3_ds, aes(Months, No_of_Songs)) +
  geom_point(color="yellow", size=2) +
  geom_smooth(method = 'lm', se=FALSE, color="red", formula = y~x) +
  stat_cor(aes(label = ..r.label..), label.x=5, label.y=600)+
  stat_regline_equation(label.x=5, label.y =555 )
```

### Task 1.5: Build a linear regression model.

```{r}
# Your code goes here
Linear_Model <- lm(No_of_Songs ~ Months, data = Mp3_ds) #creating a model
summary(Linear_Model) #summary of the model
```

### Task 1.6: Print the linear regression model coefficients.

```{r}
# Your code goes here
Linear_Model$coefficients #getting coeff of the model
```

### Task 1.7: Using the linear regression model to predict the No_of_Songs when the Months are 5.

```{r}
# Your code goes here
predict(Linear_Model, data.frame(Months = 5)) #predicting the y
```

### Task 1.8: Using the linear regression model to predict the No_of_Songs when the Months are a range of Months.

```{r}
# Your code goes here
rangevalues <- data.frame(Months <- c(4,12,10,7)) #creating a dataframe of given months
predict(Linear_Model, rangevalues) #predicting y
```


## Task 2: Multiple Linear Regression

### Task 2.1: Download the Cars_data and set the work directory where you saved the dataset.

```{r}
# Download the Cars_datadata
# Set the work directory where you saved the Cars_data
```

### Task 2.2: Load, view the Cars_ds dataset, and returning the Cars_ds dataset structure.

```{r}
# Your code goes here
Cars_ds <- read.csv("Cars_data.csv") #loading dataset
#View(Cars_ds) #view dataset
str(Cars_ds) #get str of the dataset
```

### Task 2.3: Check for Multicollinearity, but do not drop any variable 

```{r}
# Your code goes here
cor(Cars_ds, method="pearson") # Check for Multicollinearity
```

### Task 2.4: Building a linear regression model called MLR_Model1.

```{r}
# Your code goes here
options(scipen = 999) #to get absolute values
MLR_Model1 <- lm(Price ~ Year + Kilometer + Engine + MaxPower + Length + Width + Height + SeatingCapacity + FuelTankCapacity , data=Cars_ds) #building a model
summary(MLR_Model1) #summary of the model
```

### Task 2.5: Re-building a linear regression model called MLR_Model2 after dropping non-significant variables.

```{r}
# Your code goes here
# dropping 
options(scipen = 999) #to get absolute values
MLR_Model2 <- lm(Price ~ Year + Kilometer + Engine + MaxPower + FuelTankCapacity , data=Cars_ds) #building a model
summary(MLR_Model2) #summary of the new model
```

### Task 2.6: Print the MLR_Model2 model coefficients.

```{r}
# Your code goes here
MLR_Model2$coefficients # getting model coefficients
```

### Task 2.7: Predicting a car price using the predict() method.

```{r}
# Your code goes here
predict(MLR_Model2, data.frame(Year = 2022, Kilometer = 11350, Engine = 2450, MaxPower = 222, FuelTankCapacity = 5)) #predicting values
```


## Task 3: Logistic Regression

### Task 3.1: Download the Stroke_dataset and set the work directory where you saved the dataset.

```{r}
# Download the Stroke_dataset 
# Set the work directory where you saved the Stroke_dataset 
```

### Task 3.2: Download and load the required packages.

```{r}
# Your code goes here
#loading required packages
library(caTools)
library(caret)
```

### Task 3.3: Load, view the Stroke_ds dataset, and returning the Stroke_ds dataset structure.

```{r}
# Your code goes here
Stroke_ds <-read.csv("Stroke_dataset.csv") #laoding dataset
#View(Stroke_ds) #view dataset
str(Stroke_ds) #str of the dataset
```

### Task 3.4: Split the dataset into two datasets: training and testing.

```{r}
# Your code goes here
split <- sample.split(Stroke_ds$stroke, SplitRatio = 0.7) #spliting dataset
TrainData <- subset(Stroke_ds, split == "TRUE") #creating train data 
TestData <- subset(Stroke_ds, split == "FALSE") #creating test data 
```

### Task 3.5: Build a logistics regression model.

```{r}
# Your code goes here
Logistic_Model <- glm(stroke ~ age + hypertension + heart_disease + ever_married + avg_glucose_level + smoking_status , data = TrainData, family = binomial) #creating a model
summary(Logistic_Model) #summary of the model
```

### Task 3.6: Get the probability values for the train and test models but DONOT PRINT THE VALUES .

```{r}
# Your code goes here
prob_train <-predict(Logistic_Model, data=TrainData, type = "response") # probability of train data
prob_test <- predict(Logistic_Model, data=TestData, type = "response") # probability of test data
```

### Task 3.7: Generate and print the confusion matrix for the Stroke_ds dataset with a threshold of 0.5

```{r}
# Your code goes here
probability_values <- predict(Logistic_Model,Stroke_ds, type = "response" ) #getting probability values
predictClass <- ifelse(probability_values > 0.5, 1, 0) # creating a confusion matrix
confusionMatrix(as.factor(predictClass), as.factor(Stroke_ds$stroke)) #printing the matrix
```

### Task 3.8: Validate the logistic regression model by calculating the accuracy, precision, and recall.

```{r}
# Your code goes here
#calculating and displacying the accuracy, precision and recall of the model
accuracy = (4861 + 1)/ (4861 +248+0+1)
  accuracy
precision = 1/(1 +0)
  precision
recall = 1/ (1+248)
recall
```
